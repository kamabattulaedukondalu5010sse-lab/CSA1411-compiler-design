#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char input[50];
char stack[50];
int ip = 0, sp = 0;
int len;

/* Function to check reductions */
void check()
{
    /* Reduce a or b to E */
    if (stack[sp - 1] == 'a' || stack[sp - 1] == 'b')
    {
        stack[sp - 1] = 'E';

        printf("\n$%s\t\t%s$\t\tE->a/b", stack, input + ip);
    }

    /* Reduce E+E , E*E , E/E to E */
    if (sp >= 3)
    {
        if (stack[sp - 3] == 'E' &&
            (stack[sp - 2] == '+' ||
             stack[sp - 2] == '*' ||
             stack[sp - 2] == '/') &&
            stack[sp - 1] == 'E')
        {
            sp = sp - 2;
            stack[sp - 1] = 'E';
            stack[sp] = '\0';

            printf("\n$%s\t\t%s$\t\tE->E+E/E*E/E/E", stack, input + ip);
        }
    }
}

int main()
{
    printf("\n\tSHIFT REDUCE PARSER\n");
    printf("\nGrammar:");
    printf("\nE -> E+E | E*E | E/E | a | b\n");

    printf("\nEnter input string: ");
    fgets(input, sizeof(input), stdin);

    input[strcspn(input, "\n")] = '\0';   // Remove newline

    len = strlen(input);

    printf("\nStack\t\tInput\t\tAction");
    printf("\n------------------------------------");

    printf("\n$\t\t%s$\t\t--", input);

    /* Parsing */
    while (ip < len)
    {
        /* Shift */
        stack[sp] = input[ip];
        stack[sp + 1] = '\0';

        ip++;
        sp++;

        printf("\n$%s\t\t%s$\t\tSHIFT", stack, input + ip);

        /* Try Reduce */
        check();
    }

    /* Final Reduction */
    check();

    /* Acceptance */
    if (strcmp(stack, "E") == 0)
        printf("\n\nString ACCEPTED\n");
    else
        printf("\n\nString REJECTED\n");

    return 0;
}

OUTPUT:

        SHIFT REDUCE PARSER

Grammar:
E -> E+E | E*E | E/E | a | b

Enter input string: a+b

Stack           Input           Action
------------------------------------
$               a+b$            --
$a              +b$             SHIFT
$E              +b$             E->a/b
$E+             b$              SHIFT
$E+b            $               SHIFT
$E+E            $               E->a/b
$E              $               E->E+E/E*E/E/E

String ACCEPTED

